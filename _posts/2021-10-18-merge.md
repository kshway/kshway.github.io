---
title:  "[Excel] Excel로 Merge하기"
excerpt: "Excel로 쉽고 편하게 병합해보자!"

categories:
  - Excel

tags:
  - Merge

toc: true
toc_sticky: true

date: 2021-10-18
last_modified_at: 2021-10-18
---

# 개요
아예 다른 데이터 두개에서 하나의 기준으로 연결시키고, 병합시키는걸 해야한다! 하면 당연히 코딩을 해야할거라고 생각했던 나..  
하지만 엑셀로 손 쉽게 할 수 있다는 것을 알아냈다 ! 잊어버리기 전에 해놓는 기록 ㅎ  
준비물은 엑셀과 데이터 그리고 마우스 뿐 ! 그럼 시자아아아아아악  

# 데이터 확인
데이터는 내가 지금 쓰고있는 데이터를 방출시킬 수가 없어서 임의로 제작해보았다.  
첫번째 데이터는 이름, 성별, 나이, 학번이 적혀있는 학생 기본정보 데이터이다.  

![화면 캡처 2021-10-18 095409](https://user-images.githubusercontent.com/91586956/137651789-72a59525-4ffc-46f7-8e6a-ccd533ab4c2b.png)

두번째 데이터는 학번별로 기숙사 호수를 배정한 데이터이다. 일부러 방배정 데이터에는 학생기본정보에 없는 학번을 넣어서 만들어 봤다.

![화면 캡처 2021-10-18 095543](https://user-images.githubusercontent.com/91586956/137651841-b5795b1e-53a2-42e2-ab34-0978f6219108.png)

우리는 상사로부터 기숙사 호수를 학생 기본정보 데이터에 매치시키는 일을 할당받았다고 생각해보자. 그럼 우리는 눈으로 하나하나 비교하면서 볼 수도 있을 것이다. 하지만 지금은 힉생이 10명도 없지만 실제로 학생 수는 몇 천명, 몇 만명이 될 수도 있다. 그러면 절대로 사람이 수작업으로 할 수 없다.............. (내가 하고있는 자동차 데이터도 40만개 넘음) 그러므로 엑셀로 처리를 해보자!  

# 병합하기

## 쿼리 만들기

![화면 캡처 2021-10-18 100041](https://user-images.githubusercontent.com/91586956/137652116-233f59f2-b1b2-43c5-81c8-829e91b46a6d.png)

원하는 데이터가 있는 시트에 데이터-테이블/범위에서를 눌러준다
![화면 캡처 2021-10-18 100451](https://user-images.githubusercontent.com/91586956/137652336-fadefa27-781e-429e-a868-620f04411b8b.png)

그러면 알아서 데이터 범위가 조정되어 창이 뜰 것이다. ~~똑똑한 엑셀😊~~ 우리는 머리글(Header)가 있으니 머리글 포함도 체크해주자(원래 체크되어있을 것임)

또 등장한 나의 하찮은 그림 ㅎ 아래와 같은 창이 뜨면 이름을 바꿔주고 닫기 및 로드를 눌러준다 !

![화면 캡처 2021-10-18 100707](https://user-images.githubusercontent.com/91586956/137652464-c9ff41bc-f431-45de-8f2a-f0e475c07e5b.png)

이와 같은 과정으로 기숙사방배정 데이터도 쿼리로 만들어주자!  
다 잘했으면 아래와 같이 시트가 새로 만들어 질 것이당  

![화면 캡처 2021-10-18 100935](https://user-images.githubusercontent.com/91586956/137652601-50ccf78b-e9d9-40ce-92ec-c593c38177d0.png)


## 병합하기
위 과정을 함께했으면 쿼리라는 메뉴가 새로 생겼을 것이다. 메인데이터 시트를 누르고 (나중에 수정해줘도 상관 무) 쿼리에 병합을 눌러준다.

![화면 캡처 2021-10-18 101130](https://user-images.githubusercontent.com/91586956/137652682-28d2647c-4d26-4a85-a2bd-09de44850460.png)

아래와 같은 창이 뜨면 병합할 테이블을 선택하고, 무슨 행을 기준으로 할지 눌러 선택해준다.  
기준이 되는 행을 정하는 것도 중요한데 나이나 성별 이름은 사실 같은 나이, 성별, 이름이 존재할 것이므로 고유값이 되지 못한다. 따라서 학번, 주민번호와 같은 고유값을 가진 데이터를 선택하는 것이 좋다.(당연한 얘기임 하하)  
어쨌든 저기서 확인을 누르면 거의 끝!

![화면 캡처 2021-10-18 101337](https://user-images.githubusercontent.com/91586956/137652808-2068c003-75a2-45e2-a34b-0a936b7dece5.png)

아래처럼 조인 종류를 선택할 수 있는데 데이터 분석하는 사람이면 다 알거니까.. 패스.. 우리는 왼쪽데이터(학생기본정보)를 기준으로 두번째의 일치하는 행을 붙일거기때문에 왼쪽 외부(left outer)로 해준다.

![화면 캡처 2021-10-18 101555](https://user-images.githubusercontent.com/91586956/137652921-3d7d6856-f31a-4b6b-b0df-0241cf57ff32.png)

## 병합확인

여기서 붙일 행을 선택할 수 있다. 나는 잘 붙었는지 확인할겸 모든행을 선택했다. 똑같이 이름을 설정하고 닫기 및 로드를 눌러주면 된다.

![화면 캡처 2021-10-18 101840](https://user-images.githubusercontent.com/91586956/137653064-2d563505-3b1c-4076-9429-e607a910de66.png)

그럼 아래처럼 예쁜 병합된 쿼리가 나올 것이다. 이걸 새 시트에 복붙해도 되고, 쓰는건 맘대로 !! 행이름도 바꿔주고.. 어쨌든 학번을 비교해봤을때 잘 병합된 것을 확인할 수 있다. 일부러 방배정데이터에 학생기본정보에 없는 학번을 넣어서 만들어 봤었는데 그 데이터는 따로 병합되지 않았음을 볼 수 있다.   

![화면 캡처 2021-10-18 102012](https://user-images.githubusercontent.com/91586956/137653156-9cdf619a-f2d2-4b4f-becf-88fa884bb8f9.png)

# 포스팅 마무리
생각보다 너무 간단해서 깜짝 놀랐져??????? 나는 개인적으로 이걸 코드로 불러와서 merge해주는 것 보다 좀 더 간단하다고 생각했당. 물론 코드로도 할 줄 알아야함 ! 내가 만든 데이터지만 확인안해보고 막 만든거라 누구랑 룸메될지 궁금했는데 여기서도 민지랑 룸메라니 너무 웃기다 🤣 쨌든 이 포스팅은 여기까지 !!!!